{"version":3,"sources":["../src/dynatraceufo_ctrl.js"],"names":["MetricsPanelCtrl","DynatraceUfoCtrl","$scope","$injector","$interval","events","on","onInitEditMode","bind","onPanelTeardown","render","onRender","onDataReceived","onDataError","data","ctx","ufo","showUfoName","showUfoIP","showUfoWiFi","showUfoLastUpdate","showDropdown","canvasid","Math","random","topColors","bottomColors","logoColors","opacity","morphFadeOut","curColors","updateLedData","selectedUfoJson","json","filter","val","detailInfo","deviceId","selectedUfo","sort","a","b","Date","ActivityTime","ufoName","ufoClientIP","clientIP","ufoWifiSsid","ssid","ufoLastUpdate","leds","logo","map","toString","top","color","bottom","cancel","whirlIntervalTop","whirl","speed","clockwise","unshift","pop","push","shift","whirlIntervalBottom","morphIntervalTop","morph","state","substring","morphIntervalBottom","console","log","length","addEditorTab","datasets","createLEDring","backgroundColor","fillColor","label","labels","createLabels","options","responsive","aspectRatio","legend","multiTooltipTemplate","animation","config","type","document","getElementById","getContext","Chart","update","dataList","datapoints","availUfos","Set","undefined","noOfLeds","arr","Array","i","templateUrl"],"mappings":"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","file":"dynatraceufo_ctrl.js","sourcesContent":["import { MetricsPanelCtrl } from 'app/plugins/sdk';\r\nimport './css/dynatraceufo-panel.css!';\r\nimport './Chart.js'\r\n\r\nexport class DynatraceUfoCtrl extends MetricsPanelCtrl {\r\n  constructor($scope, $injector, $interval) {\r\n    super($scope, $injector);\r\n\r\n    this.events.on('init-edit-mode', this.onInitEditMode.bind(this));\r\n    this.events.on('panel-teardown', this.onPanelTeardown.bind(this));\r\n    this.events.on('panel-initialized', this.render.bind(this));\r\n\r\n    this.events.on('render', this.onRender.bind(this));\r\n    this.events.on('data-received', this.onDataReceived.bind(this));\r\n    this.events.on('data-snapshot-load', this.onDataReceived.bind(this));\r\n    this.events.on('data-error', this.onDataError.bind(this));\r\n\r\n    this.data = [];\r\n    this.ctx = null;\r\n    this.ufo = null;\r\n\r\n    this.showUfoName = true;\r\n    this.showUfoIP = true;\r\n    this.showUfoWiFi = true;\r\n    this.showUfoLastUpdate = true;\r\n    this.showDropdown = true;\r\n\r\n    this.canvasid = Math.random();\r\n\r\n    this.topColors = [];\r\n    this.bottomColors = [];\r\n    this.logoColors = [];\r\n\r\n    this.opacity = 0xff;\r\n    this.morphFadeOut = true;\r\n    this.curColors = null;\r\n\r\n    this.updateLedData = function () {\r\n      // Reset whirl and morph params\r\n      this.opacity = 0xff;\r\n      this.morphFadeOut = true;\r\n\r\n      // Get data for selected Ufo and fill array with current colors\r\n      var selectedUfoJson = this.json.filter(val => val.detailInfo.deviceId === this.selectedUfo).sort((a, b) => new Date(b.ActivityTime) - new Date(a.ActivityTime))[0];\r\n      this.ufoName = selectedUfoJson.detailInfo.ufo;\r\n      this.ufoClientIP = selectedUfoJson.detailInfo.clientIP;\r\n      this.ufoWifiSsid = selectedUfoJson.detailInfo.ssid;\r\n      this.ufoLastUpdate = selectedUfoJson.ActivityTime[0];\r\n      if (selectedUfoJson.detailInfo.leds) {\r\n        this.logoColors = selectedUfoJson.detailInfo.leds.logo.map(val => '#' + val + this.opacity.toString(16));\r\n        this.topColors = selectedUfoJson.detailInfo.leds.top.color.map(val => '#' + val + this.opacity.toString(16));\r\n        this.bottomColors = selectedUfoJson.detailInfo.leds.bottom.color.map(val => '#' + val + this.opacity.toString(16));\r\n      } else {\r\n        this.logoColors = [];\r\n        this.topColors = [];\r\n        this.bottomColors = [];\r\n      }\r\n      this.render();\r\n\r\n      // Set Whirl\r\n      $interval.cancel(this.whirlIntervalTop);\r\n      if (selectedUfoJson.detailInfo.leds.top.whirl.speed > 0) {\r\n        this.whirlIntervalTop = $interval(() => {\r\n          if (selectedUfoJson.detailInfo.leds.top.whirl.clockwise) {\r\n            this.topColors.unshift(this.topColors.pop());\r\n          } else {\r\n            this.topColors.push(this.topColors.shift());\r\n          }\r\n          this.render();\r\n        }, 1000);\r\n      }\r\n\r\n      $interval.cancel(this.whirlIntervalBottom);\r\n      if (selectedUfoJson.detailInfo.leds.bottom.whirl.speed > 0) {\r\n        this.whirlIntervalBottom = $interval(() => {\r\n          if (selectedUfoJson.detailInfo.leds.bottom.whirl.clockwise) {\r\n            this.bottomColors.unshift(this.bottomColors.pop());\r\n          } else {\r\n            this.bottomColors.push(this.bottomColors.shift());\r\n          }\r\n          this.render();\r\n        }, 1000);\r\n      }\r\n\r\n      // Set Morph\r\n      $interval.cancel(this.morphIntervalTop);\r\n      if (selectedUfoJson.detailInfo.leds.top.morph.state === 1) {\r\n        this.morphIntervalTop = $interval(() => {\r\n          if (this.morphFadeOut) {\r\n            this.opacity -= 0x0f;\r\n            if (this.opacity == 0x1e) {\r\n              this.morphFadeOut = !this.morphFadeOut;\r\n            }\r\n          } else {\r\n            this.opacity += 0x0f;\r\n            if (this.opacity == 0xff) {\r\n              this.morphFadeOut = !this.morphFadeOut;\r\n            }\r\n          }\r\n          this.topColors = this.topColors.map(val => val.substring(0, 7) + this.opacity.toString(16));\r\n          this.render();\r\n        }, 100);\r\n      }\r\n\r\n      $interval.cancel(this.morphIntervalBottom);\r\n      if (selectedUfoJson.detailInfo.leds.bottom.morph.state === 1) {\r\n        this.morphIntervalBottom = $interval(() => {\r\n          if (this.morphFadeOut) {\r\n            this.opacity -= 0x0f;\r\n            if (this.opacity == 0x1e) {\r\n              this.morphFadeOut = !this.morphFadeOut;\r\n            }\r\n          } else {\r\n            this.opacity += 0x0f;\r\n            if (this.opacity == 0xff) {\r\n              this.morphFadeOut = !this.morphFadeOut;\r\n            }\r\n          }\r\n          this.bottomColors = this.bottomColors.map(val => val.substring(0, 7) + this.opacity.toString(16));\r\n          this.render();\r\n        }, 100);\r\n      }\r\n\r\n      console.log('Visualizing UFO on IP: ' + selectedUfoJson.detailInfo.clientIP + '. Connected to WiFi: ' + selectedUfoJson.detailInfo.ssid);\r\n      console.log('UFO has ' + this.topColors.length + ' top LEDS and ' + this.bottomColors.length + ' bottom LEDS.');\r\n    }\r\n  }\r\n\r\n  onInitEditMode() {\r\n    this.addEditorTab('Options', 'public/plugins/djimmo-dynatrace-ufo/editor.html', 2);\r\n  }\r\n\r\n  onPanelTeardown() {\r\n  }\r\n\r\n  onDataError() {\r\n    console.log('There has been a data error!');\r\n    this.render();\r\n  }\r\n\r\n  onRender() {\r\n    this.data = {\r\n      datasets: [{\r\n        data: this.createLEDring(this.bottomColors.length),\r\n        backgroundColor: this.bottomColors,\r\n        fillColor: 'rgba(0,0,0,0)',\r\n        label: 'Bottom Ring'\r\n      }, {\r\n        data: this.createLEDring(this.topColors.length),\r\n        backgroundColor: this.topColors,\r\n        label: 'Top Ring'\r\n      }],\r\n      labels: this.createLabels(this.topColors.length)\r\n    };\r\n\r\n    this.options = {\r\n      responsive: true,\r\n      aspectRatio: 1.4,\r\n      legend: false,\r\n      multiTooltipTemplate: '<%= datasetLabel %> - <%= value %>',\r\n      animation: false\r\n    };\r\n\r\n    var config = {\r\n      type: 'doughnut',\r\n      data: this.data,\r\n      options: this.options\r\n    };\r\n\r\n    if (this.ctx == null)\r\n      if (document.getElementById(this.canvasid) != null)\r\n        this.ctx = document.getElementById(this.canvasid).getContext('2d');\r\n\r\n    if (this.ctx != null) {\r\n      if (this.ufo == null) {\r\n        this.ufo = new Chart(this.ctx, config);\r\n      } else {\r\n        this.ufo.data = this.data;\r\n        this.ufo.update();\r\n      }\r\n    }\r\n  }\r\n\r\n  onDataReceived(dataList) {\r\n    console.log('Data Received!');\r\n    console.log(dataList);\r\n    console.log(dataList[0].datapoints);\r\n    this.json = dataList[0].datapoints;\r\n\r\n    this.availUfos = [...new Set(this.json.map(val => val.detailInfo.deviceId))];\r\n    // this.availUfoIds = [...new Set(this.json.map(val => val.detailInfo.deviceId))];\r\n    console.log(this.availUfos);\r\n    console.log(this.selectedUfo);\r\n    if (this.selectedUfo === undefined) {\r\n      this.selectedUfo = this.availUfos[0];\r\n    }\r\n    this.updateLedData();\r\n  }\r\n\r\n  createLEDring(noOfLeds) {\r\n    var arr = new Array(noOfLeds);\r\n    for (var i = 0; i < noOfLeds; i++) {\r\n      arr[i] = 1;\r\n    }\r\n    return arr;\r\n  };\r\n\r\n  createLabels(noOfLeds) {\r\n    var arr = new Array(noOfLeds);\r\n    for (var i = 0; i < noOfLeds; i++) {\r\n      arr[i] = 'LED #' + (i + 1);\r\n    }\r\n    return arr;\r\n  }\r\n\r\n  selectUfo() {\r\n    console.log(this.selectedUfo + ' selected.');\r\n    this.updateLedData();\r\n  }\r\n}\r\n\r\nDynatraceUfoCtrl.templateUrl = 'module.html';"]}